<!DOCTYPE html>
<html>
    <head>
        <title>Start Page</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>
    <body>
        <h1>Hello World!</h1>
        <form >
            <h2>INICIO DE SESI√ìN üåç</h2>
            <label>Ingrese usuario: </label><br/>
            <input type="text" id="log"><br>
            <label>Ingrese contrase√±a: </label><br/>
            <input type="password" id="pass"><br/>
            <button id="btnLogin" type="button">Iniciar</button>
        </form>
        <script>

            btnLogin.addEventListener("click", async (event) => {
                const log = document.getElementById("log").value;
                const pass = document.getElementById("pass").value;
                event.preventDefault();
                const response = await fetch("login-normal", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({log: log, pass: pass})
                }).then(response => response.json());
                if (response.result === "ok") {
                    console.log(response.token);
                    setCookie("token", response.token, 7);
                    alert(response.result);
                    // window.location.href = "clientes.html";
                } else {
                    alert("Credenciales incorrectas");
                }
            });

            function setCookie(nombre, valor, dias) {
                const fecha = new Date();
                fecha.setTime(fecha.getTime() + (dias * 24 * 60 * 60 * 1000));
                const expira = "expires=" + fecha.toUTCString();
                document.cookie = nombre + "=" + valor + ";" + expira + ";path=/";
            }
        </script>
    </body>
</html>
